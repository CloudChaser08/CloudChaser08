-- Create a table for the transaction data
DROP TABLE IF EXISTS navicure_raw;
CREATE TABLE navicure_raw (
navicure_client_id text encode lzo,
unique_claim_id text encode lzo,
claim_revision_no text encode lzo,
claim_submit_date text encode lzo,
subscriber_member_id text encode lzo,
patient_control_number text encode lzo,
patient_last_name text encode lzo,
patient_first_name text encode lzo,
patient_date_of_birth text encode lzo,
patient_gender text encode lzo,
patient_home_address_line_1 text encode lzo,
patient_home_address_line_2 text encode lzo,
patient_home_address_city text encode lzo,
patient_home_address_state text encode lzo,
patient_home_address_zip text encode lzo,
insured_last_name text encode lzo,
insured_first_name text encode lzo,
insured_date_of_birth text encode lzo,
insured_home_address_line_1 text encode lzo,
insured_home_address_line_2 text encode lzo,
insured_home_address_city text encode lzo,
insured_home_address_state text encode lzo,
insured_home_address_zip text encode lzo,
dest_payer_responsibility text encode lzo,
dest_system_payer_entity text encode lzo,
dest_system_payer_name text encode lzo,
dest_client_payer_name text encode lzo,
dest_client_payer_id text encode lzo,
dest_claim_filing_indicator text encode lzo,
dest_insurance_type_code text encode lzo,
box9_client_payer_name text encode lzo,
box9_client_payer_id text encode lzo,
box9_claim_filing_indicator text encode lzo,
box9_insurance_type_code text encode lzo,
third_client_payer_name text encode lzo,
third_client_payer_id text encode lzo,
third_claim_filing_indicator text encode lzo,
third_insurance_type_code text encode lzo,
total_claim_charge_amount text encode lzo,
referring_1_last_name text encode lzo,
referring_1_first_name text encode lzo,
referring_1_middle_name text encode lzo,
referring_provider_1_npi text encode lzo,
referring_1_state_license_no text encode lzo,
referring_1_upin text encode lzo,
referring_1_commercial_id text encode lzo,
rendering_last_name text encode lzo,
rendering_first_name text encode lzo,
rendering_middle_name text encode lzo,
rendering_provider_npi text encode lzo,
rendering_taxonomy_code text encode lzo,
rendering_state_license_no text encode lzo,
rendering_upin text encode lzo,
rendering_commercial text encode lzo,
facility_organization_name text encode lzo,
facility_npi text encode lzo,
facility_street_address_line_1 text encode lzo,
facility_street_address_line_2 text encode lzo,
facility_street_address_city text encode lzo,
facility_street_address_state text encode lzo,
facility_street_address_zip text encode lzo,
billing_organization_name text encode lzo,
billing_last_name text encode lzo,
billing_first_name text encode lzo,
billing_middle_name text encode lzo,
billing_npi text encode lzo,
billing_tax_id text encode lzo,
billing_tax_id_qualifier text encode lzo,
billing_taxonomy_code text encode lzo,
billing_state_license_no text encode lzo,
billing_commercial text encode lzo,
billing_street_address_line_1 text encode lzo,
billing_street_address_line_2 text encode lzo,
billing_street_address_city text encode lzo,
billing_street_address_state text encode lzo,
billing_street_address_zip text encode lzo,
icd9_code_1 text encode lzo,
icd9_code_2 text encode lzo,
icd9_code_3 text encode lzo,
icd9_code_4 text encode lzo,
icd9_code_5 text encode lzo,
icd9_code_6 text encode lzo,
icd9_code_7 text encode lzo,
icd9_code_8 text encode lzo,
icd9_code_9 text encode lzo,
icd9_code_10 text encode lzo,
icd9_code_11 text encode lzo,
icd9_code_12 text encode lzo,
icd10_code_1 text encode lzo,
icd10_code_2 text encode lzo,
icd10_code_3 text encode lzo,
icd10_code_4 text encode lzo,
icd10_code_5 text encode lzo,
icd10_code_6 text encode lzo,
icd10_code_7 text encode lzo,
icd10_code_8 text encode lzo,
icd10_code_9 text encode lzo,
icd10_code_10 text encode lzo,
icd10_code_11 text encode lzo,
icd10_code_12 text encode lzo,
service_line text encode lzo,
service_from_date text encode lzo,
service_to_date text encode lzo,
place_of_service_code text encode lzo,
product_service_id text encode lzo,
procedure_modifier_1 text encode lzo,
procedure_modifier_2 text encode lzo,
procedure_modifier_3 text encode lzo,
procedure_modifier_4 text encode lzo,
diagnosis_code_1 text encode lzo,
diagnosis_code_2 text encode lzo,
diagnosis_code_3 text encode lzo,
diagnosis_code_4 text encode lzo,
service_unit_count text encode lzo,
service_ane_minutes text encode lzo,
ndc_drug_code text encode lzo,
line_item_charge_amount text encode lzo,
hvJoinKey text encode lzo)
DISTKEY(hvJoinKey) SORTKEY(hvJoinKey);

-- Load transaction data into table
copy navicure_raw from :input_path credentials :credentials EMPTYASNULL FILLRECORD BZIP2;
