DROP TABLE IF EXISTS transactional_raw;
CREATE TABLE transactional_raw (
        src_claim_id                   ENCODE text lzo,
        claim_type_cd                  ENCODE text lzo,
        edi_interchange_creation_dt    ENCODE text lzo,
        edi_interchange_creation_time  ENCODE text lzo,
        orgntr_app_txn_id              ENCODE text lzo,
        billg_provdr_txnmy             ENCODE text lzo,
        billg_provdr_npi               ENCODE text lzo,
        billg_provdr_tax_id            ENCODE text lzo,
        billg_provdr_stlc_nbr          ENCODE text lzo,
        billg_provdr_upin              ENCODE text lzo,
        billg_provdr_last_or_orgal_nm  ENCODE text lzo,
        billg_provdr_first_nm          ENCODE text lzo,
        billg_provdr_addr_1            ENCODE text lzo,
        billg_provdr_addr_2            ENCODE text lzo,
        billg_provdr_addr_city         ENCODE text lzo,
        billg_provdr_addr_state        ENCODE text lzo,
        billg_provdr_addr_zip          ENCODE text lzo,
        pay_to_provdr_addr_1           ENCODE text lzo,
        pay_to_provdr_addr_2           ENCODE text lzo,
        pay_to_provdr_city             ENCODE text lzo,
        pay_to_provdr_state            ENCODE text lzo,
        pay_to_provdr_zip              ENCODE text lzo,
        dest_payer_nm                  ENCODE text lzo,
        dest_payer_cms_plan_id         ENCODE text lzo,
        dest_payer_id                  ENCODE text lzo,
        dest_payer_claim_offc_nbr      ENCODE text lzo,
        dest_payer_naic_id             ENCODE text lzo,
        dest_payer_tax_id              ENCODE text lzo,
        dest_payer_group_nbr           ENCODE text lzo,
        dest_payer_group_nm            ENCODE text lzo,
        dest_payer_claim_flng_ind_cd   ENCODE text lzo,
        tot_claim_charg_amt            ENCODE text lzo,
        fclty_type_pos_cd              ENCODE text lzo,
        claim_freq_cd                  ENCODE text lzo,
        asgmt_signtr                   ENCODE text lzo,
        release_signtr                 ENCODE text lzo,
        accdnt_related_ind             ENCODE text lzo,
        stmnt_from_dt                  ENCODE text lzo,
        stmnt_to_dt                    ENCODE text lzo,
        admsn_dt                       ENCODE text lzo,
        dischg_dt                      ENCODE text lzo,
        admsn_type_cd                  ENCODE text lzo,
        admsn_src_cd                   ENCODE text lzo,
        patnt_sts_cd                   ENCODE text lzo,
        prinpl_diag_cd                 ENCODE text lzo,
        prinpl_diag_prior_onset_ind    ENCODE text lzo,
        admtg_diag_cd                  ENCODE text lzo,
        patnt_rsn_for_visit_01         ENCODE text lzo,
        patnt_rsn_for_visit_02         ENCODE text lzo,
        patnt_rsn_for_visit_03         ENCODE text lzo,
        ecodes                         ENCODE text lzo,
        drg_cd                         ENCODE text lzo,
        dx                             ENCODE text lzo,
        prinpl_proc_cd                 ENCODE text lzo,
        other_proc_codes               ENCODE text lzo,
        refrn_provdr_npi               ENCODE text lzo,
        refrn_provdr_id                ENCODE text lzo,
        refrn_provdr_upin              ENCODE text lzo,
        refrn_provdr_comm_nbr          ENCODE text lzo,
        refrn_provdr_stlc_nbr          ENCODE text lzo,
        refrn_provdr_last_nm           ENCODE text lzo,
        refrn_provdr_first_nm          ENCODE text lzo,
        rendr_provdr_npi               ENCODE text lzo,
        rendr_provdr_id                ENCODE text lzo,
        rendr_provdr_upin              ENCODE text lzo,
        rendr_provdr_comm_nbr          ENCODE text lzo,
        rendr_provdr_loc_nbr           ENCODE text lzo,
        rendr_provdr_stlc_nbr          ENCODE text lzo,
        rendr_provdr_last_nm           ENCODE text lzo,
        rendr_provdr_first_nm          ENCODE text lzo,
        rendr_provdr_txnmy             ENCODE text lzo,
        fclty_npi                      ENCODE text lzo,
        fclty_id                       ENCODE text lzo,
        fclty_comm_nbr                 ENCODE text lzo,
        fclty_loc_nbr                  ENCODE text lzo,
        fclty_stlc_nbr                 ENCODE text lzo,
        fclty_nm                       ENCODE text lzo,
        fclty_addr_1                   ENCODE text lzo,
        fclty_addr_2                   ENCODE text lzo,
        fclty_addr_city                ENCODE text lzo,
        fclty_addr_state               ENCODE text lzo,
        fclty_addr_zip                 ENCODE text lzo,
        suprv_provdr_npi               ENCODE text lzo,
        suprv_provdr_upin              ENCODE text lzo,
        suprv_provdr_comm_nbr          ENCODE text lzo,
        suprv_provdr_loc_nbr           ENCODE text lzo,
        suprv_provdr_stlc_nbr          ENCODE text lzo,
        suprv_provdr_last_nm           ENCODE text lzo,
        suprv_provdr_first_nm          ENCODE text lzo,
        attdn_provdr_npi               ENCODE text lzo,
        attdn_provdr_id                ENCODE text lzo,
        attdn_provdr_upin              ENCODE text lzo,
        attdn_provdr_comm_nbr          ENCODE text lzo,
        attdn_provdr_loc_nbr           ENCODE text lzo,
        attdn_provdr_stlc_nbr          ENCODE text lzo,
        attdn_provdr_last_nm           ENCODE text lzo,
        attdn_provdr_first_nm          ENCODE text lzo,
        attdn_provdr_txnmy             ENCODE text lzo,
        oprtn_provdr_npi               ENCODE text lzo,
        oprtn_provdr_id                ENCODE text lzo,
        oprtn_provdr_upin              ENCODE text lzo,
        oprtn_provdr_comm_nbr          ENCODE text lzo,
        oprtn_provdr_loc_nbr           ENCODE text lzo,
        oprtn_provdr_stlc_nbr          ENCODE text lzo,
        oprtn_provdr_last_nm           ENCODE text lzo,
        oprtn_provdr_first_nm          ENCODE text lzo,
        other_oprtn_provdr_npi         ENCODE text lzo,
        other_oprtn_provdr_id          ENCODE text lzo,
        other_oprtn_provdr_upin        ENCODE text lzo,
        other_oprtn_provdr_comm_nbr    ENCODE text lzo,
        other_oprtn_provdr_loc_nbr     ENCODE text lzo,
        other_oprtn_provdr_stlc_nbr    ENCODE text lzo,
        other_oprtn_provdr_last_nm     ENCODE text lzo,
        other_oprtn_provdr_first_nm    ENCODE text lzo,
        other_diag_codes               ENCODE text lzo,
        src_svc_id                     ENCODE text lzo,
        line_nbr                       ENCODE text lzo,
        svc_from_dt                    ENCODE text lzo,
        svc_to_dt                      ENCODE text lzo,
        proc_cd_qual                   ENCODE text lzo,
        proc_cd                        ENCODE text lzo,
        proc_modfr_1                   ENCODE text lzo,
        proc_modfr_2                   ENCODE text lzo,
        proc_modfr_3                   ENCODE text lzo,
        proc_modfr_4                   ENCODE text lzo,
        line_charg                     ENCODE text lzo,
        units                          ENCODE text lzo,
        pos_cd                         ENCODE text lzo,
        diag_cd_1                      ENCODE text lzo,
        diag_cd_2                      ENCODE text lzo,
        diag_cd_3                      ENCODE text lzo,
        diag_cd_4                      ENCODE text lzo,
        revnu_cd                       ENCODE text lzo,
        tst_rslt_hgb                   ENCODE text lzo,
        tst_rslt_hematocrit            ENCODE text lzo,
        tst_rslt_epoetin               ENCODE text lzo,
        tst_rslt_creatinine            ENCODE text lzo,
        tst_rslt_hgt                   ENCODE text lzo,
        line_item_cntl_nbr             ENCODE text lzo,
        ndc                            ENCODE text lzo,
        ndc_unit_cnt                   ENCODE text lzo,
        ndc_uom                        ENCODE text lzo,
        rendr_provdr_npi_svc           ENCODE text lzo,
        rendr_provdr_txnmy_svc         ENCODE text lzo,
        purchase_svc_provdr_npi        ENCODE text lzo,
        fclty_npi_svc                  ENCODE text lzo,
        suprv_provdr_npi_svc           ENCODE text lzo,
        ordrg_provdr_npi               ENCODE text lzo,
        refrn_provdr_npi               ENCODE text lzo,
        oprtn_provdr_npi               ENCODE text lzo,
        other_oprtn_provdr_npi         ENCODE text lzo
        ) DISTKEY(src_claim_id) SORTKEY(src_claim_id);

COPY transactional_raw FROM :input_path CREDENTIALS :credentials BZIP2 EMPTYASNULL DELIMITER '|';
