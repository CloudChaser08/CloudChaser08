DROP TABLE IF EXISTS emdeon_rx_raw;
CREATE TABLE emdeon_rx_raw (
record_id text encode lzo,
date_authorized text encode lzo,
time_authorized text encode lzo,
bin_number text encode lzo,
version_number text encode lzo,
transaction_code text encode lzo,
processor_control_number text encode lzo,
transaction_count text encode lzo,
service_provider_id text encode lzo,
service_provider_id_qualifier text encode lzo,
date_service text encode lzo,
year_of_birth text encode lzo,
gender_code text encode lzo,
patient_location text encode lzo,
patient_first_name text encode lzo,
patient_last_name text encode lzo,
patient_street_address text encode lzo,
patient_state_province text encode lzo,
patient_zip3 text encode lzo,
patient_id_qualifier text encode lzo,
patient_id text encode lzo,
provider_id text encode lzo,
prov_dispensing_qual text encode lzo,
prescriber_id text encode lzo,
primary_care_provider_id text encode lzo,
prescriber_last_name text encode lzo,
prov_prescribing_qual text encode lzo,
prov_primary_care_qual text encode lzo,
group_id text encode lzo,
cardholder_id text encode lzo,
person_code text encode lzo,
patient_relationship_code text encode lzo,
eligibility_clarification_code text encode lzo,
home_plan text encode lzo,
cob_count text encode lzo,
other_payer_coverage_type text encode lzo,
other_payer_coverage_qual text encode lzo,
other_payer_coverage_id text encode lzo,
other_payer_amount_paid_qualifier text encode lzo,
other_payer_amount_paid_submitted text encode lzo,
other_payer_date text encode lzo,
carrier_id text encode lzo,
date_injury text encode lzo,
claim_reference_id text encode lzo,
other_payer_coverage_code text encode lzo,
rx_number text encode lzo,  --internal pharmacy claim number
fill_number text encode lzo,
days_supply text encode lzo,
compound_code text encode lzo,
product_service_id text encode lzo,   --ndc code or something else
dispensed_as_written text encode lzo,
date_written text encode lzo,
refill_auth_amount text encode lzo,
level_of_service text encode lzo,
prescription_origin text encode lzo,
submission_clarification text encode lzo,
unit_dose_indicator text encode lzo,
product_service_id_qualifier text encode lzo,   --will indicate what kind of ProductServiceID it is  "03" indicates NDC code
dispensed_quantity text encode lzo,
orig_prescribed_product_service_code text encode lzo,
orig_prescribed_quantity text encode lzo,
orig_prescribed_product_service_code_qual text encode lzo,
rx_number_qual text encode lzo,
prior_auth_type_code text encode lzo,
unit_of_measure text encode lzo,
reason_for_service text encode lzo,
professional_service_code text encode lzo,
result_of_service_code text encode lzo,
coupon_type text encode lzo,
coupon_number text encode lzo,
coupon_value text encode lzo,
submitted_ingredient_cost text encode lzo,
submitted_dispensing_fee text encode lzo,
basis_of_cost_determination text encode lzo,
usual_and_customary_charge text encode lzo,
submitted_patient_pay text encode lzo,
submitted_gross_due text encode lzo,
submitted_incentive text encode lzo,
submitted_professional_service_fee text encode lzo,
submitted_other_claimed_qual text encode lzo,
submitted_other_claimed text encode lzo,
submitted_flat_sales_tax text encode lzo,
submitted_percent_sales_tax_amount text encode lzo,
submitted_percent_sales_tax_rate text encode lzo,
submitted_percent_sales_tax_basis text encode lzo,
diagnosis_code text encode lzo,
diagnosis_code_qual text encode lzo,
response_code text encode lzo,
paid_patient_pay text encode lzo,
paid_ingredient_cost text encode lzo,
paid_dispensing_fee text encode lzo,
paid_gross_due text encode lzo,
accumulated_deductible text encode lzo,
remaining_deductible text encode lzo,
remaining_benefit text encode lzo,
periodic_deductible_applied text encode lzo,
copay_coinsurance text encode lzo,
product_selection_attributed text encode lzo,
periodic_benefit_exceed text encode lzo,
incentive_paid text encode lzo,
basis_of_reimbursement_determination text encode lzo,
sales_tax text encode lzo,
tax_exempt_indicator text encode lzo,
paid_flat_sales_tax text encode lzo,
paid_percentage_sales_tax_amount text encode lzo,
paid_percent_sales_tax_rate text encode lzo,
paid_percent_sales_tax_basis text encode lzo,
paid_professional_service_fee text encode lzo,
paid_other_claimed_qual text encode lzo,
paid_other_claimed text encode lzo,
other_payer_recognized text encode lzo,
payer_plan_id text encode lzo,
ncpdp_number text encode lzo,
pharmacy_npi text encode lzo,
plan_type text encode lzo,
pharmacy_postal_code text encode lzo,
reject_reason_code_1 text encode lzo,
reject_reason_code_2 text encode lzo,
reject_reason_code_3 text encode lzo,
reject_reason_code_4 text encode lzo,
reject_reason_code_5 text encode lzo,
payer_id text encode lzo,
payer_id_qual text encode lzo,
payer_plan_name text encode lzo,
payer_type text encode lzo,
claim_id text encode lzo) DISTKEY(claim_id) SORTKEY(claim_id);    --claimId to match the deid'd PHI

-- Load transaction data into table
copy emdeon_rx_raw from :input_path credentials :credentials BZIP2 EMPTYASNULL TRIMBLANKS FIXEDWIDTH 'record_id:1,date_authorized:8,time_authorized:6,bin_number:6,version_number:2,transaction_code:2,processor_control_number:10,transaction_count:1,service_provider_id:15,service_provider_id_qualifier:2,date_service:8,year_of_birth:8,gender_code:1,patient_location:2,patient_first_name:12,patient_last_name:15,patient_street_address:30,patient_state_province:2,patient_zip3:15,patient_id_qualifier:2,patient_id:20,provider_id:15,prov_dispensing_qual:2,prescriber_id:15,primary_care_provider_id:15,prescriber_last_name:15,prov_prescribing_qual:2,prov_primary_care_qual:2,group_id:15,cardholder_id:20,person_code:3,patient_relationship_code:1,eligibility_clarification_code:1,home_plan:3,cob_count:1,other_payer_coverage_type:2,other_payer_coverage_qual:2,other_payer_coverage_id:10,other_payer_amount_paid_qualifier:2,other_payer_amount_paid_submitted:10,other_payer_date:8,carrier_id:10,date_injury:8,claim_reference_id:30,other_payer_coverage_code:2,rx_number:12,fill_number:2,days_supply:3,compound_code:1,product_service_id:19,dispensed_as_written:1,date_written:8,refill_auth_amount:2,level_of_service:2,prescription_origin:1,submission_clarification:2,unit_dose_indicator:1,product_service_id_qualifier:2,dispensed_quantity:11,orig_prescribed_product_service_code:19,orig_prescribed_quantity:11,orig_prescribed_product_service_code_qual:2,rx_number_qual:1,prior_auth_type_code:2,unit_of_measure:2,reason_for_service:2,professional_service_code:2,result_of_service_code:2,coupon_type:2,coupon_number:15,coupon_value:8,submitted_ingredient_cost:10,submitted_dispensing_fee:10,basis_of_cost_determination:2,usual_and_customary_charge:10,submitted_patient_pay:10,submitted_gross_due:10,submitted_incentive:10,submitted_professional_service_fee:10,submitted_other_claimed_qual:2,submitted_other_claimed:10,submitted_flat_sales_tax:10,submitted_percent_sales_tax_amount:10,submitted_percent_sales_tax_rate:9,submitted_percent_sales_tax_basis:2,diagnosis_code:15,diagnosis_code_qual:2,response_code:1,paid_patient_pay:10,paid_ingredient_cost:10,paid_dispensing_fee:10,paid_gross_due:10,accumulated_deductible:10,remaining_deductible:10,remaining_benefit:10,periodic_deductible_applied:10,copay_coinsurance:10,product_selection_attributed:10,periodic_benefit_exceed:10,incentive_paid:10,basis_of_reimbursement_determination:2,sales_tax:10,tax_exempt_indicator:1,paid_flat_sales_tax:10,paid_percentage_sales_tax_amount:10,paid_percent_sales_tax_rate:9,paid_percent_sales_tax_basis:2,paid_professional_service_fee:10,paid_other_claimed_qual:2,paid_other_claimed:10,other_payer_recognized:10,payer_plan_id:8,ncpdp_number:7,pharmacy_npi:10,plan_type:1,pharmacy_postal_code:5,reject_reason_code_1:3,reject_reason_code_2:3,reject_reason_code_3:3,reject_reason_code_4:3,reject_reason_code_5:3,payer_id:10,payer_id_qual:2,payer_plan_name:80,payer_type:10,claim_id:23';
