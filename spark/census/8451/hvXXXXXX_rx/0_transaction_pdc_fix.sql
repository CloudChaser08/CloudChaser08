SELECT
    txn.med_identity_id                                   AS med_identity_id,
    txn.first_name                                        AS first_name,
    txn.last_name                                         AS last_name,
    txn.year_of_birth                                     AS year_of_birth,
    txn.patient_age                                       AS patient_age,
    txn.birth_date                                        AS birth_date,
    txn.gender_code                                       AS gender_code,
    txn.address_line1_name                                AS address_line1_name,
    txn.address_line2_name                                AS address_line2_name,
    txn.address_city_name                                 AS address_city_name,
    txn.address_state_prov_code                           AS address_state_prov_code,
    txn.address_postal_code                               AS address_postal_code,
    txn.benefit_group_code                                AS benefit_group_code,
    txn.med_phm_fill_code                                 AS med_phm_fill_code,
    txn.card_code                                         AS card_code,
    txn.primary_processor_control_number_code             AS primary_processor_control_number_code,
    txn.secondary_processor_control_number_code           AS secondary_processor_control_number_code,
    txn.primary_bank_industry_number_code                 AS primary_bank_industry_number_code,
    txn.secondary_bank_industry_number_code               AS secondary_bank_industry_number_code,
    txn.med_phm_fill_fid                                  AS med_phm_fill_fid,
    txn.rx_number                                         AS rx_number,
    txn.refill_authorization_amount                       AS refill_authorization_amount,
    txn.date_ordered                                      AS date_ordered,
    txn.date_cancelled                                    AS date_cancelled,
    txn.transaction_date                                  AS transaction_date,
    txn.date_sold                                         AS date_sold,
    txn.product_prescribed                                AS product_prescribed,
    txn.product_dispensed                                 AS product_dispensed,
    txn.dispense_as_written_description                   AS dispense_as_written_description,
    txn.generic_substitution_description                  AS generic_substitution_description,
    txn.refill_sequence_number                            AS refill_sequence_number,
    txn.prescribed_quantity                               AS prescribed_quantity,
    txn.dispensed_quantity                                AS dispensed_quantity,
    txn.intended_duration                                 AS intended_duration,
    txn.actual_duration                                   AS actual_duration,
    txn.prescriber_code                                   AS prescriber_code,
    txn.pharmacy_code                                     AS pharmacy_code,
    txn.pharmacy_zip                                      AS pharmacy_zip,
    txn.return_to_stock_flag                              AS return_to_stock_flag,
    txn.fill_status_code                                  AS fill_status_code,
    txn.partial_fill_code                                 AS partial_fill_code,
    txn.government_funded_flag                            AS government_funded_flag,
    txn.total_patient_pay_amt                             AS total_patient_pay_amt,
    txn.total_pay_amt                                     AS total_pay_amt,
    txn.cash_override_amt                                 AS cash_override_amt,
    txn.division_id                                       AS division_id,
    txn.prescription_code                                 AS prescription_code,
    txn.prescribed_product_commodity                      AS prescribed_product_commodity,
    txn.prescribed_product_subcommodity                   AS prescribed_product_subcommodity,
    txn.prescribed_product_therapeutic_class_code         AS prescribed_product_therapeutic_class_code,
    txn.prescribed_product_therapeutic_class_description  AS prescribed_product_therapeutic_class_description,
    txn.prescribed_product_generic_flag                   AS prescribed_product_generic_flag,
    txn.prescribed_product_generic_name                   AS prescribed_product_generic_name,
    txn.prescribed_product_maintenance_drug_flag          AS prescribed_product_maintenance_drug_flag,
    txn.prescribed_product_compound_code                  AS prescribed_product_compound_code,
    txn.prescribed_product_strength_code                  AS prescribed_product_strength_code,
    txn.prescribed_product_strength_quantity              AS prescribed_product_strength_quantity,
    txn.prescribed_product_ndc                            AS prescribed_product_ndc,
    txn.dispensed_product_description                     AS dispensed_product_description,
    txn.dispensed_product_commodity                       AS dispensed_product_commodity,
    txn.dispensed_product_subcommodity                    AS dispensed_product_subcommodity,
    txn.dispensed_product_therapeutic_class_code          AS dispensed_product_therapeutic_class_code,
    txn.dispensed_product_therapeutic_class_description   AS dispensed_product_therapeutic_class_description,
    txn.dispensed_product_generic_flag                    AS dispensed_product_generic_flag,
    txn.dispensed_product_generic_name                    AS dispensed_product_generic_name,
    txn.dispensed_product_maintenance_drug_flag           AS dispensed_product_maintenance_drug_flag,
    txn.dispensed_product_compound_code                   AS dispensed_product_compound_code,
    txn.dispensed_product_strength_code                   AS dispensed_product_strength_code,
    txn.dispensed_product_strength_quantity               AS dispensed_product_strength_quantity,
    txn.dispensed_product_ndc                             AS dispensed_product_ndc,
    /*update only the pdc values*/
    COALESCE(pdc.pdc_diabetes, txn.pdc_diabetes)          AS pdc_diabetes,
    COALESCE(pdc.pdc_rasa, txn.pdc_rasa)                  AS pdc_rasa,
    COALESCE(pdc.pdc_statins, txn.pdc_statins)            AS pdc_statins,
    /*--------------------------*/
    txn.payer_type                                        AS payer_type,
    txn.hvjoinkey                                         AS hvjoinkey,
    txn.input_file_name                                   AS input_file_name
FROM 8451_transactions txn
LEFT OUTER JOIN pdc_fix pdc ON txn.med_phm_fill_fid = pdc.med_phm_fill_fid
