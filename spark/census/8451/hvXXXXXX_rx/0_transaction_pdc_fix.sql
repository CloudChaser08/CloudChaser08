SELECT
    txn.med_identity_id,
    txn.first_name,
    txn.last_name,
    txn.year_of_birth,
    txn.patient_age,
    txn.birth_date,
    txn.gender_code,
    txn.address_line1_name,
    txn.address_line2_name,
    txn.address_city_name,
    txn.address_state_prov_code,
    txn.address_postal_code,
    txn.benefit_group_code,
    txn.med_phm_fill_code,
    txn.card_code,
    txn.primary_processor_control_number_code,
    txn.secondary_processor_control_number_code,
    txn.primary_bank_industry_number_code,
    txn.secondary_bank_industry_number_code,
    txn.med_phm_fill_fid,
    txn.rx_number,
    txn.refill_authorization_amount,
    txn.date_ordered,
    txn.date_cancelled,
    txn.transaction_date,
    txn.date_sold,
    txn.product_prescribed,
    txn.product_dispensed,
    txn.dispense_as_written_description,
    txn.generic_substitution_description,
    txn.refill_sequence_number,
    txn.prescribed_quantity,
    txn.dispensed_quantity,
    txn.intended_duration,
    txn.actual_duration,
    txn.prescriber_code,
    txn.pharmacy_code,
    txn.pharmacy_zip,
    txn.return_to_stock_flag,
    txn.fill_status_code,
    txn.partial_fill_code,
    txn.government_funded_flag,
    txn.total_patient_pay_amt,
    txn.total_pay_amt,
    txn.cash_override_amt,
    txn.division_id,
    txn.prescription_code,
    txn.prescribed_product_commodity,
    txn.prescribed_product_subcommodity,
    txn.prescribed_product_therapeutic_class_code,
    txn.prescribed_product_therapeutic_class_description,
    txn.prescribed_product_generic_flag,
    txn.prescribed_product_generic_name,
    txn.prescribed_product_maintenance_drug_flag,
    txn.prescribed_product_compound_code,
    txn.prescribed_product_strength_code,
    txn.prescribed_product_strength_quantity,
    txn.prescribed_product_ndc,
    txn.dispensed_product_description,
    txn.dispensed_product_commodity,
    txn.dispensed_product_subcommodity,
    txn.dispensed_product_therapeutic_class_code,
    txn.dispensed_product_therapeutic_class_description,
    txn.dispensed_product_generic_flag,
    txn.dispensed_product_generic_name,
    txn.dispensed_product_maintenance_drug_flag,
    txn.dispensed_product_compound_code,
    txn.dispensed_product_strength_code,
    txn.dispensed_product_strength_quantity,
    txn.dispensed_product_ndc,
    /*update only the pdc values*/
    COALESCE(pdc.pdc_diabetes, txn.pdc_diabetes),
    COALESCE(pdc.pdc_rasa, txn.pdc_rasa),
    COALESCE(pdc.pdc_statins, txn.pdc_statins),
    /*--------------------------*/
    txn.payer_type,
    txn.hvjoinkey                   	                    
FROM 8451_grocerry_transactions txn
LEFT OUTER JOIN pdc_fix pdc ON txn.med_phm_fill_fid = pdc.med_phm_fill_fid
