SELECT
    f.id as field_id,
    f.category as category,
    f.description as description,
    f.physical_name as name,
    f.sequence as sequence,
    t.id as table_id,
    t.description as table_desc,
    t.name as table_name,
    t.sequence as table_seq,
    ft.name as field_type_name
FROM marketplace_datafield f
JOIN marketplace_fieldtype ft on ft.id = f.field_type_id
JOIN marketplace_datatable t on t.id = f.datatable_id
JOIN marketplace_datamodel m on m.id = t.datamodel_id
JOIN marketplace_datafeed_datamodels dm on dm.datamodel_id = m.id
WHERE dm.datafeed_id = 10 and m.is_supplemental = 'f';


query_str = (
    """
    SELECT
        {values}
    FROM marketplace_datafield f
    JOIN marketplace_fieldtype ft on ft.id = f.field_type_id
    JOIN marketplace_datatable t on t.id = f.datatable_id
    JOIN marketplace_datamodel m on m.id = t.datamodel_id
    JOIN marketplace_datafeed_datamodels dm on dm.datamodel_id = m.id
    WHERE dm.datafeed_id = 10 and m.is_supplemental = 'f';
    """
)


our_conf = {
    'f.id': 'field_id',
}

values_str = ''
for db_loc, value_name in our_conf.items():
    values_str += '{location} as {name}\n'.format(
        location=db_loc, name=value_name
    )

values_str = """
    f.physical_name as name,
    f.id as field_id,
    f.category as category,
    f.description as description,
    f.sequence as sequence,
    t.id as table_id,
    t.description as table_desc,
    t.name as table_name,
    t.sequence as table_seq,
    ft.name as field_type_name
"""


query_str.format(values=values_str)