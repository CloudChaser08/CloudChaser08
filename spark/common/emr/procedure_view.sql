DROP VIEW IF EXISTS dw.hvm_emr_proc;
CREATE VIEW dw.hvm_emr_proc (
        row_id,
        hv_proc_id,
        crt_dt,
        mdl_vrsn_num,
        data_set_nm,
        src_vrsn_id,
        hvm_vdr_id,
        hvm_vdr_feed_id,
        vdr_org_id,
        vdr_proc_id,
        vdr_proc_id_qual,
        hvid,
        ptnt_birth_yr,
        ptnt_age_num,
        ptnt_lvg_flg,
        ptnt_dth_dt,
        ptnt_gender_cd,
        ptnt_state_cd,
        ptnt_zip3_cd,
        hv_enc_id,
        enc_dt,
        proc_dt,
        proc_rndrg_fclty_taxnmy_id,
        proc_rndrg_fclty_speclty_Id,
        proc_rndrg_fclty_state_cd,
        proc_rndrg_fclty_zip_cd,
        proc_rndrg_prov_taxnmy_id,
        proc_rndrg_prov_speclty_Id,
        proc_rndrg_prov_state_cd,
        proc_rndrg_prov_zip_cd,
        proc_cd,
        proc_cd_qual,
        proc_cd_1_modfr,
        proc_cd_2_modfr,
        proc_cd_3_modfr,
        proc_cd_4_modfr,
        proc_cd_modfr_qual,
        proc_snomed_cd,
        proc_prty_cd,
        proc_prty_cd_qual,
        proc_alt_cd,
        proc_alt_cd_qual,
        proc_pos_cd,
        proc_unit_qty,
        proc_uom,
        proc_diag_cd,
        proc_diag_cd_qual,
        data_captr_dt,
        rec_stat_cd,
        part_hvm_vdr_feed_id,
        part_mth
        ) AS SELECT
    row_id,
    hv_proc_id,
    crt_dt,
    mdl_vrsn_num,
    data_set_nm,
    src_vrsn_id,
    hvm_vdr_id,
    hvm_vdr_feed_id,
    vdr_org_id,
    vdr_proc_id,
    vdr_proc_id_qual,
    hvid,
    ptnt_birth_yr,
    ptnt_age_num,
    ptnt_lvg_flg,
    ptnt_dth_dt,
    ptnt_gender_cd,
    ptnt_state_cd,
    ptnt_zip3_cd,
    hv_enc_id,
    enc_dt,
    proc_dt,
    COALESCE(proc_rndrg_fclty_nucc_taxnmy_cd, proc_rndrg_fclty_alt_taxnmy_id),
    COALESCE(proc_rndrg_fclty_mdcr_speclty_cd, proc_rndrg_fclty_alt_speclty_id),
    proc_rndrg_fclty_state_cd,
    proc_rndrg_fclty_zip_cd,
    COALESCE(proc_rndrg_prov_nucc_taxnmy_cd, proc_rndrg_prov_alt_taxnmy_id),
    COALESCE(proc_rndrg_prov_mdcr_speclty_cd, proc_rndrg_prov_alt_speclty_id),
    proc_rndrg_prov_state_cd,
    proc_rndrg_prov_zip_cd,
    proc_cd,
    proc_cd_qual,
    proc_cd_1_modfr,
    proc_cd_2_modfr,
    proc_cd_3_modfr,
    proc_cd_4_modfr,
    proc_cd_modfr_qual,
    proc_snomed_cd,
    proc_prty_cd,
    proc_prty_cd_qual,
    proc_alt_cd,
    proc_alt_cd_qual,
    proc_pos_cd,
    proc_unit_qty,
    proc_uom,
    proc_diag_cd,
    proc_diag_cd_qual,
    data_captr_dt,
    rec_stat_cd,
    part_hvm_vdr_feed_id,
    part_mth
FROM dw.emr_proc
    ;
