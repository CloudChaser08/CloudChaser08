-- Select the medical claims common model into a new table
DROP TABLE IF EXISTS final_unload;
CREATE TABLE final_unload(
record_id bigint,
claim_id string,
hvid string,
created date,
model_version string,
data_set date,
data_feed date,
data_vendor date,
source_version string,
patient_gender string,
patient_age string,
patient_year_of_birth string,
patient_zip3 string,
patient_state string,
date_service string,
date_written string,
date_injury string,
date_authorized string,
time_authorized string,
transaction_code_std string,
transaction_code_vendor string,
response_code_std string,
response_code_vendor string,
reject_reason_code_1 string,
reject_reason_code_2 string,
reject_reason_code_3 string,
reject_reason_code_4 string,
reject_reason_code_5 string,
diagnosis_code string,
diagnosis_code_qual string,
procedure_code string,
procedure_code_qual string,
ndc_code string,
product_service_id string,
product_service_id_qual string,
rx_number string,
rx_number_qual string,
bin_number string,
processor_control_number string,
fill_number float,
refill_auth_amount string,
dispensed_quantity float,
unit_of_measure string,
days_supply float,
pharmacy_npi string,
prov_dispensing_npi string,
payer_id string,
payer_id_qual string,
payer_name string,
payer_parent_name string,
payer_org_name string,
payer_plan_id string,
payer_plan_name string,
payer_type string,
compound_code string,
unit_dose_indicator string,
dispensed_as_written string,
prescription_origin string,
submission_clarification string,
orig_prescribed_product_service_code string,
orig_prescribed_product_service_code_qual string,
orig_prescribed_quantity string,
prior_auth_type_code string,
level_of_service string,
reason_for_service string,
professional_service_code string,
result_of_service_code string,
prov_prescribing_npi string,
prov_primary_care_npi string,
cob_count string,
usual_and_customary_charge float,
sales_tax float,
product_selection_attributed float,
other_payer_recognized float,
periodic_deductible_applied float,
periodic_benefit_exceed float,
accumulated_deductible float,
remaining_deductible float,
remaining_benefit float,
copay_coinsurance float,
basis_of_cost_determination float,
submitted_ingredient_cost float,
submitted_dispensing_fee float,
submitted_incentive float,
submitted_gross_due float,
submitted_professional_service_fee float,
submitted_flat_sales_tax float,
submitted_percent_sales_tax_basis float,
submitted_percent_sales_tax_rate float,
submitted_percent_sales_tax_amount float,
submitted_patient_pay float,
submitted_other_claimed_qual float,
submitted_other_claimed float,
basis_of_reimbursement_determination float,
paid_ingredient_cost float,
paid_dispensing_fee float,
paid_incentive float,
paid_gross_due float,
paid_professional_service_fee float,
paid_flat_sales_tax float,
paid_percent_sales_tax_basis float,
paid_percent_sales_tax_rate float,
paid_percent_sales_tax float,
paid_patient_pay float,
paid_other_claimed_qual float,
paid_other_claimed float,
tax_exempt_indicator string,
coupon_type string,
coupon_number string,
coupon_value float,
pharmacy_other_id string,
pharmacy_other_qual string,
pharmacy_postal_code string,
prov_dispensing_id string,
prov_dispensing_qual string,
prov_prescribing_id string,
prov_prescribing_qual string,
prov_primary_care_id string,
prov_primary_care_qual string,
other_payer_coverage_type string,
other_payer_coverage_id string,
other_payer_coverage_qual string,
other_payer_date date,
other_payer_coverage_code string,
logical_delete_reason string
)
PARTITIONED BY (part_best_date string)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
    'separatorChar' = '|'
)
LOCATION {table_location};

