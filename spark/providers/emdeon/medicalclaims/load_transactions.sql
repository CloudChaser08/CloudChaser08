-- Create a table for the transaction data
DROP TABLE IF EXISTS emdeon_dx_raw;
CREATE EXTERNAL TABLE emdeon_dx_raw (
column1 string,
column2 string,
column3 string,
column4 string,
column5 string,
column6 string,
column7 string,
column8 string,
column9 string,
column10 string,
column11 string,
column12 string,
column13 string,
column14 string,
column15 string,
column16 string,
column17 string,
column18 string,
column19 string,
column20 string,
column21 string,
column22 string,
column23 string,
column24 string,
column25 string,
column26 string,
column27 string,
column28 string,
column29 string,
column30 string,
column31 string,
column32 string,
column33 string,
column34 string,
column35 string,
column36 string,
column37 string,
column38 string,
column39 string,
column40 string,
column41 string,
column42 string,
column43 string,
column44 string,
column45 string,
column46 string,
column47 string,
column48 string,
column49 string,
column50 string,
column51 string,
column52 string,
column53 string,
column54 string,
column55 string,
column56 string,
column57 string,
column58 string,
column59 string,
column60 string,
column61 string,
column62 string,
column63 string,
column64 string,
column65 string,
column66 string,
column67 string,
column68 string,
column69 string,
column70 string,
column71 string,
column72 string,
column73 string,
column74 string,
column75 string,
column76 string,
column77 string,
column78 string,
column79 string,
column80 string,
column81 string,
column82 string,
column83 string,
column84 string,
column85 string,
column86 string,
column87 string,
column88 string,
column89 string,
column90 string,
column91 string,
column92 string,
column93 string,
column94 string,
column95 string,
column96 string,
column97 string,
column98 string,
column99 string,
column100 string,
column101 string,
column102 string,
column103 string,
column104 string,
column105 string,
column106 string,
column107 string,
column108 string,
column109 string,
column110 string,
column111 string,
column112 string,
column113 string,
column114 string,
column115 string,
column116 string,
column117 string,
column118 string,
column119 string,
column120 string,
column121 string,
column122 string,
column123 string,
column124 string,
column125 string,
column126 string,
column127 string,
column128 string,
column129 string,
column130 string,
column131 string,
column132 string,
column133 string,
column134 string,
column135 string,
column136 string,
column137 string,
column138 string,
column139 string,
column140 string,
column141 string,
column142 string,
column143 string,
column144 string,
column145 string,
column146 string,
column147 string,
column148 string,
column149 string,
column150 string,
column151 string,
column152 string,
column153 string,
column154 string,
column155 string,
column156 string,
column157 string,
column158 string,
column159 string,
column160 string,
column161 string,
column162 string,
column163 string,
column164 string,
column165 string,
column166 string,
column167 string,
column168 string,
column169 string,
column170 string,
column171 string
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
    'separatorChar' = '|'
)
STORED AS TEXTFILE
LOCATION {input_path};

-- Create a table for the transaction data
set hive.exec.dynamic.partition.mode=nonstrict;
DROP TABLE IF EXISTS emdeon_dx_raw_local;
CREATE TABLE emdeon_dx_raw_local (
column1 string,
column2 string,
column3 string,
column4 string,
column5 string,
column6 string,
column7 string,
column8 string,
column9 string,
column10 string,
column11 string,
column12 string,
column13 string,
column14 string,
column15 string,
column16 string,
column17 string,
column18 string,
column19 string,
column20 string,
column21 string,
column22 string,
column23 string,
column24 string,
column25 string,
column26 string,
column27 string,
column28 string,
column29 string,
column30 string,
column31 string,
column32 string,
column33 string,
column34 string,
column35 string,
column36 string,
column37 string,
column38 string,
column39 string,
column40 string,
column41 string,
column42 string,
column43 string,
column44 string,
column45 string,
column46 string,
column47 string,
column48 string,
column49 string,
column50 string,
column51 string,
column52 string,
column53 string,
column54 string,
column55 string,
column56 string,
column57 string,
column58 string,
column59 string,
column60 string,
column61 string,
column62 string,
column63 string,
column64 string,
column65 string,
column66 string,
column67 string,
column68 string,
column69 string,
column70 string,
column71 string,
column72 string,
column73 string,
column74 string,
column75 string,
column76 string,
column77 string,
column78 string,
column79 string,
column80 string,
column81 string,
column82 string,
column83 string,
column84 string,
column85 string,
column86 string,
column87 string,
column88 string,
column89 string,
column90 string,
column91 string,
column92 string,
column93 string,
column94 string,
column95 string,
column96 string,
column97 string,
column98 string,
column99 string,
column100 string,
column101 string,
column102 string,
column103 string,
column104 string,
column105 string,
column106 string,
column107 string,
column108 string,
column109 string,
column110 string,
column111 string,
column112 string,
column113 string,
column114 string,
column115 string,
column116 string,
column117 string,
column118 string,
column119 string,
column120 string,
column121 string,
column122 string,
column123 string,
column124 string,
column125 string,
column126 string,
column127 string,
column128 string,
column129 string,
column130 string,
column131 string,
column132 string,
column133 string,
column134 string,
column135 string,
column136 string,
column137 string,
column138 string,
column139 string,
column140 string,
column141 string,
column142 string,
column143 string,
column144 string,
column145 string,
column146 string,
column147 string,
column148 string,
column149 string,
column150 string,
column151 string,
column152 string,
column153 string,
column154 string,
column155 string,
column156 string,
column157 string,
column158 string,
column159 string,
column160 string,
column161 string,
column162 string,
column163 string,
column164 string,
column165 string,
column166 string,
column167 string,
column168 string,
column169 string,
column170 string,
column171 string
)
PARTITIONED BY (part_record_type string);
INSERT INTO emdeon_dx_raw_local SELECT *, column2 as part_record_type FROM emdeon_dx_raw;

