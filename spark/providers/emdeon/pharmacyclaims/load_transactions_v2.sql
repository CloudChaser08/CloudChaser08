DROP TABLE IF EXISTS emdeon_rx_raw;
CREATE EXTERNAL TABLE emdeon_rx_raw (
record_id string,
date_authorized string,
time_authorized string,
bin_number string,
version_number string,
transaction_code string,
processor_control_number string,
transaction_count string,
service_provider_id string,
service_provider_id_qualifier string,
date_service string,
year_of_birth string,
gender_code string,
patient_location string,
patient_first_name string,
patient_last_name string,
patient_street_address string,
patient_state_province string,
patient_zip3 string,
patient_id_qualifier string,
patient_id string,
provider_id string,
prov_dispensing_qual string,
prescriber_id string,
primary_care_provider_id string,
prescriber_last_name string,
prov_prescribing_qual string,
prov_primary_care_qual string,
group_id string,
cardholder_id string,
person_code string,
patient_relationship_code string,
eligibility_clarification_code string,
home_plan string,
cob_count string,
other_payer_coverage_type string,
other_payer_coverage_qual string,
other_payer_coverage_id string,
other_payer_amount_paid_qualifier string,
other_payer_amount_paid_submitted string,
other_payer_date string,
carrier_id string,
date_injury string,
claim_reference_id string,
other_payer_coverage_code string,
rx_number string,  --internal pharmacy claim number
fill_number string,
days_supply string,
compound_code string,
product_service_id string,   --ndc code or something else
dispensed_as_written string,
date_written string,
refill_auth_amount string,
level_of_service string,
prescription_origin string,
submission_clarification string,
unit_dose_indicator string,
product_service_id_qualifier string,   --will indicate what kind of ProductServiceID it is  "03" indicates NDC code
dispensed_quantity string,
orig_prescribed_product_service_code string,
orig_prescribed_quantity string,
orig_prescribed_product_service_code_qual string,
rx_number_qual string,
prior_auth_type_code string,
unit_of_measure string,
reason_for_service string,
professional_service_code string,
result_of_service_code string,
coupon_type string,
coupon_number string,
coupon_value string,
submitted_ingredient_cost string,
submitted_dispensing_fee string,
basis_of_cost_determination string,
usual_and_customary_charge string,
submitted_patient_pay string,
submitted_gross_due string,
submitted_incentive string,
submitted_professional_service_fee string,
submitted_other_claimed_qual string,
submitted_other_claimed string,
submitted_flat_sales_tax string,
submitted_percent_sales_tax_amount string,
submitted_percent_sales_tax_rate string,
submitted_percent_sales_tax_basis string,
diagnosis_code string,
diagnosis_code_qual string,
response_code string,
paid_patient_pay string,
paid_ingredient_cost string,
paid_dispensing_fee string,
paid_gross_due string,
accumulated_deductible string,
remaining_deductible string,
remaining_benefit string,
periodic_deductible_applied string,
copay_coinsurance string,
product_selection_attributed string,
periodic_benefit_exceed string,
incentive_paid string,
basis_of_reimbursement_determination string,
sales_tax string,
tax_exempt_indicator string,
paid_flat_sales_tax string,
paid_percentage_sales_tax_amount string,
paid_percent_sales_tax_rate string,
paid_percent_sales_tax_basis string,
paid_professional_service_fee string,
paid_other_claimed_qual string,
paid_other_claimed string,
other_payer_recognized string,
payer_plan_id string,
ncpdp_number string,
pharmacy_npi string,
plan_type string,
pharmacy_postal_code string,
reject_reason_code_1 string,
reject_reason_code_2 string,
reject_reason_code_3 string,
reject_reason_code_4 string,
reject_reason_code_5 string,
payer_id string,
payer_id_qual string,
payer_plan_name string,
payer_type string,
claim_id string
)
ROW FORMAT SERDE
'org.apache.hadoop.hive.serde2.RegexSerDe'
WITH SERDEPROPERTIES 
(
    "input.regex" = "^(.{{1}})(.{{8}})(.{{6}})(.{{6}})(.{{2}})(.{{2}})(.{{10}})(.{{1}})(.{{15}})(.{{2}})(.{{8}})(.{{8}})(.{{1}})(.{{2}})(.{{12}})(.{{15}})(.{{30}})(.{{2}})(.{{15}})(.{{2}})(.{{20}})(.{{15}})(.{{2}})(.{{15}})(.{{15}})(.{{15}})(.{{2}})(.{{2}})(.{{15}})(.{{20}})(.{{3}})(.{{1}})(.{{1}})(.{{3}})(.{{1}})(.{{2}})(.{{2}})(.{{10}})(.{{2}})(.{{10}})(.{{8}})(.{{10}})(.{{8}})(.{{30}})(.{{2}})(.{{12}})(.{{2}})(.{{3}})(.{{1}})(.{{19}})(.{{1}})(.{{8}})(.{{2}})(.{{2}})(.{{1}})(.{{2}})(.{{1}})(.{{2}})(.{{11}})(.{{19}})(.{{11}})(.{{2}})(.{{1}})(.{{2}})(.{{2}})(.{{2}})(.{{2}})(.{{2}})(.{{2}})(.{{15}})(.{{8}})(.{{10}})(.{{10}})(.{{2}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{2}})(.{{10}})(.{{10}})(.{{10}})(.{{9}})(.{{2}})(.{{15}})(.{{2}})(.{{1}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{10}})(.{{2}})(.{{10}})(.{{1}})(.{{10}})(.{{10}})(.{{9}})(.{{2}})(.{{10}})(.{{2}})(.{{10}})(.{{10}})(.{{8}})(.{{7}})(.{{10}})(.{{1}})(.{{5}})(.{{3}})(.{{3}})(.{{3}})(.{{3}})(.{{3}})(.{{10}})(.{{2}})(.{{80}})(.{{10}})(.{{22}}).*"
)
STORED AS TEXTFILE
LOCATION {input_path}
