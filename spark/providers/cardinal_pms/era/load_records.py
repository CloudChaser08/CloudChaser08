"""
cardinal pms load record
"""
import spark.helpers.postprocessor as postprocessor
import spark.helpers.records_loader as records_loader


def load(runner, input_path_prefix, test=False):

    for t in TABLES:
        df = records_loader \
            .load(runner, input_path_prefix + t, TABLE_COLUMNS[t], 'csv', '|') \
            .repartition(1 if test else 500)
        postprocessor \
            .compose(postprocessor.trimmify, postprocessor.nullify)(df) \
            .repartition(1 if test else 5000) \
            .cache_and_track(t) \
            .createOrReplaceTempView(t)


TABLES = ['remit_claim', 'remit_claim_adjustment', 'serviceline', 'serviceline_adjustment']

TABLE_COLUMNS = {
    'remit_claim': [
        'master_patient_id',
        'claimdisproportionateshareamount',
        'claimdrgamount',
        'claimendperiod',
        'claimendperiodqualifier',
        'claimindirectteachingamount',
        'claimmsppassthroughamount',
        'claimpaymentamount',
        'claimpaymentremarkcode',
        'claimpaymentremarkcodefour',
        'claimpaymentremarkcodeone',
        'claimpaymentremarkcodethree',
        'claimpaymentremarkcodetwo',
        'claimppscapitalamount',
        'claimppscapitaloutlieramount',
        'claimreceiveddate',
        'claimreceiveddatequalifier',
        'claimsequencenumber',
        'claimstartperiod',
        'claimstartperiodqualifier',
        'claimstatuscode',
        'coinsuredqualifiercode',
        'coinsuredquantity',
        'contactonecommunicationnumberone',
        'contactonecommunicationnumberqualifierone',
        'contactonecommunicationnumberqualifierthree',
        'contactonecommunicationnumberqualifiertwo',
        'contactonecommunicationnumberthree',
        'contactonecommunicationnumbertwo',
        'contactonefunctioncode',
        'contactonename',
        'contacttwocommunicationnumberone',
        'contacttwocommunicationnumberqualifierone',
        'contacttwocommunicationnumberqualifierthree',
        'contacttwocommunicationnumberqualifiertwo',
        'contacttwocommunicationnumberthree',
        'contacttwocommunicationnumbertwo',
        'contacttwofunctioncode',
        'contacttwoname',
        'correctedpatiententityidentifiercode',
        'correctedpatiententitytypequalifier',
        'correctedpatientfirstname',
        'correctedpatientidentificationcode',
        'correctedpatientidentificationcodequalifier',
        'correctedpatientlastname',
        'correctedpatientmiddlename',
        'correctedpatientnameprefix',
        'correctedpatientnamesuffix',
        'correctedprioritypayerentityidentifiercode',
        'correctedprioritypayerentitytypequalifier',
        'correctedprioritypayerfirstname',
        'correctedprioritypayeridentificationcode',
        'correctedprioritypayeridentificationcodequalifier',
        'correctedprioritypayerlastname',
        'correctedprioritypayermiddlename',
        'correctedprioritypayernameprefix',
        'correctedprioritypayernamesuffix',
        'costreportdaycount',
        'coverageamount',
        'coverageamountqualifiercode',
        'coverageexpirationdate',
        'coverageexpirationdatequalifier',
        'coverdaysorvisitscount',
        'coveredqualifiercode',
        'coveredquantity',
        'crossovercarrierentityidentifiercode',
        'crossovercarrierentitytypequalifier',
        'crossovercarrierfirstname',
        'crossovercarrieridentificationcode',
        'crossovercarrieridentificationcodequalifier',
        'crossovercarrierlastname',
        'crossovercarriermiddlename',
        'crossovercarriernameprefix',
        'crossovercarriernamesuffix',
        'diagnosisrelatedgroupdrgcode',
        'diagnosisrelatedgroupdrgweight',
        'dischargefraction',
        'discountamount',
        'discountamountqualifiercode',
        'facilitytypecode',
        'fedmedcat1amount',
        'fedmedcat1amountqualifiercode',
        'fedmedcat2amount',
        'fedmedcat2amountqualifiercode',
        'fedmedcat3amount',
        'fedmedcat3amountqualifiercode',
        'fedmedcat4amount',
        'fedmedcat4amountqualifiercode',
        'fedmedcat5amount',
        'fedmedcat5amountqualifiercode',
        'fedmedcatfivequantity',
        'fedmedcatfivequantityqualifiercode',
        'fedmedcatfourquantity',
        'fedmedcatfourquantityqualifiercode',
        'fedmedcatonequantity',
        'fedmedcatonequantityqualifiercode',
        'fedmedcatthreequantity',
        'fedmedcatthreequantityqualifiercode',
        'fedmedcattwoquantity',
        'fedmedcattwoquantityqualifiercode',
        'filingindicatorcode',
        'frequencycode',
        'id',
        'insuredentityidentifiercode',
        'insuredentitytypequalifier',
        'insuredfirstname',
        'insuredidentificationcode',
        'insuredidentificationcodequalifier',
        'insuredlastname',
        'insuredmiddlename',
        'insurednameprefix',
        'insurednamesuffix',
        'interestamount',
        'interestamountqualifiercode',
        'lifetimepsychiatricdayscount',
        'lifetimereservedactualqualifiercode',
        'lifetimereservedactualquantity',
        'lifetimereservedestimatedqualifiercode',
        'lifetimereservedestimatedquantity',
        'negativeledgeramount',
        'negativeledgeramountqualifiercode',
        'noncoveredqualifiercode',
        'noncoveredquantity',
        'nonpayableprofessionalcomponentamount',
        'notreplacedqualifiercode',
        'notreplacedquantity',
        'oldcapitalamount',
        'othersubscriberentityidentifiercode',
        'othersubscriberentitytypequalifier',
        'othersubscriberfirstname',
        'othersubscriberidentificationcode',
        'othersubscriberidentificationcodequalifier',
        'othersubscriberlastname',
        'othersubscribermiddlename',
        'othersubscribernameprefix',
        'othersubscribernamesuffix',
        'outlierdaysqualifiercode',
        'outlierdaysquantity',
        'patientcontrolnumber',
        'patiententityidentifiercode',
        'patiententitytypequalifier',
        'patientfirstname',
        'patientidentificationcode',
        'patientidentificationcodequalifier',
        'patientlastname',
        'patientmiddlename',
        'patientnameprefix',
        'patientnamesuffix',
        'patientpaidamount',
        'patientpaidamountqualifiercode',
        'patientresponsibilityamount',
        'payerclaimcontrolnumber',
        'perdiemamount',
        'perdiemamountqualifiercode',
        'ppscapitaldshdrgamount',
        'ppscapitalexceptionamount',
        'ppscapitalfspdrgamount',
        'ppscapitalhspdrgamount',
        'ppscapitalimeamount',
        'ppsoperatingfederalspecificdrgamount',
        'ppsoperatinghospitalspecificdrgamount',
        'ppsoperatingoutlieramount',
        'prescriptionqualifiercode',
        'prescriptionquantity',
        'referenceidentification',
        'referenceidentificationqualifier',
        'renderingproviderreferenceidentification',
        'renderingproviderreferenceidentificationqualifier',
        'serviceproviderentityidentifiercode',
        'serviceproviderentitytypequalifier',
        'serviceproviderfirstname',
        'serviceprovideridentificationcode',
        'serviceprovideridentificationcodequalifier',
        'serviceproviderlastname',
        'serviceprovidermiddlename',
        'serviceprovidernameprefix',
        'serviceprovidernamesuffix',
        'taxamount',
        'taxamountqualifiercode',
        'tenant_id',
        'totalclaimbeforetaxesamount',
        'totalclaimbeforetaxesamountqualifiercode',
        'totalclaimchargeamount',
        'visitsqualifiercode',
        'visitsquantity',
        'acknowledgementrequested',
        'applicationreceiverid',
        'applicationsendercode',
        'authorizationinformation',
        'authorizationinformationqualifier',
        'componentelementseparator',
        'debitcreditindicator',
        'formatcode',
        'functionalidentifiercode',
        'groupcontrolnumber',
        'groupdatetime',
        'importsourceid',
        'industryidentifier',
        'interchangecontrolnumber',
        'interchangecontrolstandardsidentifier',
        'interchangecontrolversionnumber',
        'interchangedatetime',
        'interchangereceiverid',
        'interchangereceiveridqualifier',
        'interchangesenderid',
        'interchangesenderidqualifier',
        'mapdatetime',
        'mapversion',
        'originatorextraid',
        'originatorid',
        'payeeaccountnumber',
        'payeeaccountqualifier',
        'payeeaddressone',
        'payeeaddresstwo',
        'payeebankid',
        'payeebankidqualifier',
        'payeecity',
        'payeeextraid',
        'payeeextraidqualifier',
        'payeeid',
        'payeename',
        'payeenpid',
        'payeenpidqualifier',
        'payeestate',
        'payeezip',
        'payeraccountnumber',
        'payeraccountqualifier',
        'payeraddressone',
        'payeraddresstwo',
        'payerbankid',
        'payerbankidqualifier',
        'payerbusinesscontactemailone',
        'payerbusinesscontactemailtwo',
        'payerbusinesscontactfacsimileone',
        'payerbusinesscontactfacsimiletwo',
        'payerbusinesscontactphoneone',
        'payerbusinesscontactphonetwo',
        'payerbusinesscontacttelephoneextensionone',
        'payerbusinesscontacttelephoneextensiontwo',
        'payercarrierid',
        'payercity',
        'payername',
        'payerstate',
        'receiverid',
        'remitamount',
        'remitdatetime',
        'remittracenumber',
        'responsibleagencycode',
        'securityinformation',
        'securityinformationqualifier',
        'usageindicator'
    ],
    'remit_claim_adjustment': [
        'adjustmentamountfive',
        'adjustmentamountfour',
        'adjustmentamountone',
        'adjustmentamountsix',
        'adjustmentamountthree',
        'adjustmentamounttwo',
        'adjustmentgroupcode',
        'adjustmentquantityfive',
        'adjustmentquantityfour',
        'adjustmentquantityone',
        'adjustmentquantitysix',
        'adjustmentquantitythree',
        'adjustmentquantitytwo',
        'adjustmentreasoncodefive',
        'adjustmentreasoncodefour',
        'adjustmentreasoncodeone',
        'adjustmentreasoncodesix',
        'adjustmentreasoncodethree',
        'adjustmentreasoncodetwo',
        'id',
        'remitclaim_id'
    ],
    'serviceline': [
        'healthcarepolicyidentificationfive',
        'healthcarepolicyidentificationfour',
        'healthcarepolicyidentificationone',
        'healthcarepolicyidentificationqualifierfive',
        'healthcarepolicyidentificationqualifierfour',
        'healthcarepolicyidentificationqualifierone',
        'healthcarepolicyidentificationqualifierthree',
        'healthcarepolicyidentificationqualifiertwo',
        'healthcarepolicyidentificationthree',
        'healthcarepolicyidentificationtwo',
        'id',
        'lineitemchargeamount',
        'lineitemcontrolnumber',
        'lineitemcontrolnumberqualifier',
        'lineitemproviderpayment',
        'nubcrevenuecode',
        'proceduremodifierfour',
        'proceduremodifierone',
        'proceduremodifierthree',
        'proceduremodifiertwo',
        'productserviceid',
        'productserviceidqualifier',
        'quantity',
        'referenceidentificationone',
        'referenceidentificationqualifierone',
        'referenceidentificationqualifiertwo',
        'referenceidentificationtwo',
        'remitclaim_id',
        'renderingprovidereight',
        'renderingproviderfive',
        'renderingproviderfour',
        'renderingprovideridentificationqualifiereight',
        'renderingprovideridentificationqualifierfive',
        'renderingprovideridentificationqualifierfour',
        'renderingprovideridentificationqualifiernine',
        'renderingprovideridentificationqualifierone',
        'renderingprovideridentificationqualifierseven',
        'renderingprovideridentificationqualifiersix',
        'renderingprovideridentificationqualifierten',
        'renderingprovideridentificationqualifierthree',
        'renderingprovideridentificationqualifiertwo',
        'renderingprovidernine',
        'renderingproviderone',
        'renderingproviderseven',
        'renderingprovidersix',
        'renderingproviderten',
        'renderingproviderthree',
        'renderingprovidertwo',
        'secondarydescription',
        'secondaryproceduremodifierfour',
        'secondaryproceduremodifierone',
        'secondaryproceduremodifierthree',
        'secondaryproceduremodifiertwo',
        'secondaryproductserviceid',
        'secondaryproductserviceidqualifier',
        'secondaryquantity',
        'servicedate',
        'servicedatetimequalifier',
        'allowed_amt'
    ],
    'serviceline_adjustment': [
        'adjustmentamountfive',
        'adjustmentamountfour',
        'adjustmentamountone',
        'adjustmentamountsix',
        'adjustmentamountthree',
        'adjustmentamounttwo',
        'adjustmentgroupcode',
        'adjustmentquantityfive',
        'adjustmentquantityfour',
        'adjustmentquantityone',
        'adjustmentquantitysix',
        'adjustmentquantitythree',
        'adjustmentquantitytwo',
        'adjustmentreasoncodefive',
        'adjustmentreasoncodefour',
        'adjustmentreasoncodeone',
        'adjustmentreasoncodesix',
        'adjustmentreasoncodethree',
        'adjustmentreasoncodetwo',
        'id',
        'remitserviceline_id'
    ]
}
