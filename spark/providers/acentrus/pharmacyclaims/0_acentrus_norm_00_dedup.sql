SELECT
    row_level_id,
    gender,
    race,
    ethnicity,
    icd9cm_primary_diagnosis_related_to_current_prescription_order,
    icd9cm_secondary_diagnosis_related_to_current_prescription_order,
    icd10cm_primary_diagnosis_related_to_current_prescription_order,
    icd10cm_secondary_diagnosis_related_to_current_prescription_order,
    prescriber_npi_number,
    pharmacy_npi_number,
    prescription_ndc,
    full_product_generic_name,
    prescription_number,
    prescription_written_date,
    total_prescription_refills_allowed,
    refills_remaining,
    prescription_transferred_to,
    prescription_transferred_from,
    directions,
    rems_medication_guide_provided,
    referral_date,
    referral_receipt_date,
    referral_completed_date,
    referral_number,
    referral_status_reason_code,
    referral_status_date,
    transaction_number,
    pharmacy_receipt_date,
    prescription_type,
    dispense_status,
    dispense_status_date,
    dispense_quantity,
    days_supply,
    prior_authorization_required,
    prior_authorization_obtained,
    prior_authorization_number,
    shipping_date,
    shipping_address_1,
    shipping_address_2,
    shipping_city,
    shipping_state,
    shipping_zip_code,
    shipping_carrier,
    shipping_carrier_tracking_number,
    primary_pharmacy_payor_id_code,
    primary_pharmacy_payor_plan_patient_id,
    primary_pharmacy_payor_person_code,
    primary_pharmacy_payor_bin,
    primary_pharmacy_payor_pcn,
    primary_pharmacy_payor_group_number,
    primary_pharmacy_payor_copay,
    primary_pharmacy_payor_out_of_pocket_oop_maximum,
    primary_pharmacy_payor_out_of_pocket_oop_amount_paid,
    secondary_pharmacy_payor_id_code,
    secondary_pharmacy_payor_plan_patient_id,
    secondary_pharmacy_payor_person_code,
    secondary_pharmacy_payor_bin,
    secondary_pharmacy_payor_pcn,
    secondary_pharmacy_payor_group_number,
    secondary_pharmacy_payor_copay,
    secondary_pharmacy_payor_out_of_pocket_oop_maximum,
    secondary_pharmacy_payor_out_of_pocket_oop_amount_paid,
    patient_assistance_program,
    patient_assistance_source,
    patient_assistance_amount,
    primary_medical_payor_plan_code,
    primary_medical_payor_plan_patient_id,
    primary_medical_payor_person_code,
    primary_medical_payor_group_number,
    prior_authorization_effective_date,
    prior_authorization_expiration_date,
    prescription_transfer_date,
    last_update_date,
    last_recorded_patient_height_related_to_current_prescription_order,
    last_recorded_patient_weight_related_to_current_prescription_order,
    MAX(txn.input_file_name) as input_file_name
FROM txn
WHERE
    TRIM(UPPER(COALESCE(txn.row_level_id, 'empty')))  <> 'ROW LEVEL ID'
GROUP BY
    1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,
    21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,
    41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,
    61,62,63,64,65,66,67,68,69,70,71,72,73,74,75
