DROP TABLE IF EXISTS {restriction_level}_transactions;
CREATE EXTERNAL TABLE {restriction_level}_transactions (
        FillerRecordID                         string,
        PrescriptionKey                        string,
        PatientID                              string,
        PatientFirstName                       string,
        PatientLastName                        string,
        PatientGenderCode                      string,
        PatientAge                             string,
        PatientDateofBirth                     string,
        PatientAddress                         string,
        PatientCity                            string,
        PatientState                           string,
        PatientZipCode                         string,
        DateFilled                             string,
        DateWritten                            string,
        FillerDateofInjury                     string,
        ClaimTransactionDate                   string,
        FillerTransactionTime                  string,
        RebillIndicator                        string,
        CAMStatusCode                          string,
        RejectCode1                            string,
        RejectCode2                            string,
        RejectCode3                            string,
        RejectCode4                            string,
        RejectCode5                            string,
        DiagnosisCode                          string,
        DiagnosisCodeQualifier                 string,
        ProcedureCode                          string,
        ProcedureCodeQualifier                 string,
        DispensedNDCNumber                     string,
        FillerProductServiceID                 string,
        ProductServiceIDQualifier              string,
        PrescriptionNumber                     string,
        PrescriptionNumberQualifier            string,
        BINNumber                              string,
        ProcessControlNumber                   string,
        RefillCode                             string,
        NumberofRefillsAuthorized              string,
        MetricQuantity                         string,
        UnitOfMeasure                          string,
        DaysSupply                             string,
        CustomerNPINumber                      string,
        PharmacistNPI                          string,
        PayerID                                string,
        PayerIDQualifier                       string,
        PayerName                              string,
        FillerPayerParentName                  string,
        PayerOrgName                           string,
        PayerPlanID                            string,
        PlanName                               string,
        PayerType                              string,
        CompoundIndicator                      string,
        UnitDoseIndicator                      string,
        DispensedAsWritten                     string,
        OriginofRx                             string,
        SubmissionClarificationCode            string,
        PrescribedNDCNumber                    string,
        PrescribedProductServiceCodeQualifier  string,
        PrescribedQuantity                     string,
        PriorAuthTypeCode                      string,
        LevelofService                         string,
        ReasonforService                       string,
        ProfessionalServiceCode                string,
        ResultofServiceCode                    string,
        PrescriberNPI                          string,
        PrimaryCareProviderID                  string,
        COBCount                               string,
        UsualandCustomary                      string,
        AmountAttribtoSalesTax                 string,
        ProductSelectionAttributed             string,
        OtherPayerAmountPaid                   string,
        PeriodicDeductibleApplied              string,
        PeriodicBenefitExceed                  string,
        AccumulatedDeductible                  string,
        RemainingDeductible                    string,
        RemainingBenefit                       string,
        CopayAmount                            string,
        BasisofIngredientCostSubmitted         string,
        IngredientCostSubmitted                string,
        DispensingFeeSubmitted                 string,
        IncentiveAmountSubmitted               string,
        GrossAmountDue                         string,
        ProfessionalServiceFeeSubmitted        string,
        FlatSalesTaxAmtSubmitted               string,
        BasisOfPercentageSalesTaxSubmitted     string,
        PercentageSalesTaxRateSubmitted        string,
        PercentageSalesTaxAmountSubmitted      string,
        PatientPayAmountSubmitted              string,
        OtherAmountSubmittedQualfier           string,
        FillerOtherAmountSubmitted             string,
        BasisofIngredientCostPaid              string,
        IngredientCostPaid                     string,
        DispensingFeePaid                      string,
        IncentiveAmountPaid                    string,
        GrossAmountDuePaid                     string,
        ProfessionalServiceFeePaid             string,
        FlatSalesTaxAmountPaid                 string,
        BasisOfPercentageSalesTaxPaid          string,
        PercentageSalesTaxRatePaid             string,
        PercentageSalesTaxAmountPaid           string,
        PatientPayAmountPaid                   string,
        OtherAmountPaidQualifier               string,
        PaidOtherClaimed                       string,
        TaxExemptIndicator                     string,
        CouponType                             string,
        CouponIDNumber                         string,
        CouponFaceValue                        string,
        PharmacyOtherID                        string,
        PharmacyOtherIDQualifier               string,
        CustomerZipCode                        string,
        ProviderDispensingNPI                  string,
        ProvDispensingQual                     string,
        PrimaryCareProviderID2_ignore          string,
        PrimaryCareProviderIDQualifier         string,
        OtherPayerCoverageType                 string,
        OtherPayerCoverageID                   string,
        OtherPayerCoverageIDQualifier          string,
        OtherPayerDate                         string,
        OtherPayerCoverageCode                 string,
        HvJoinKey                              string
        )
    ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
    WITH SERDEPROPERTIES (
        'separatorChar' = '|'
        )
    STORED AS TEXTFILE
    LOCATION {input_path}
    ;
