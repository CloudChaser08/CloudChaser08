import json
import logging
import os
from contextlib import closing
import psycopg2
from spark.helpers.file_utils import get_abs_path
from spark.stats.config.dates import dates as provider_dates
import argparse
import copy
import inspect
import spark.spark_setup as spark_setup
import spark.helpers.file_utils as file_utils
import spark.stats.config.reader.config_reader as config_reader
import spark.stats.stats_writer as stats_writer
import spark.stats.processor as processor


from spark.stats.config.reader.config_reader import (
    extract_provider_conf, get_config_from_json
)


feed_id = '10'

providers_conf_file = '/Users/jmacintosh/src/hv/dewey/spark/stats/config/providers.json'
providers_conf = get_config_from_json(providers_conf_file)
provider_conf = extract_provider_conf(feed_id, providers_conf)


spark, sqlContext = spark_setup.init('Test', True)

sampled_dataframe, _ = _get_sampled_provider_data(
    spark, sqlContext, provider_conf, '1900-01-01', '2019-12-25'
)
